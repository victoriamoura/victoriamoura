import{cartRecovery,collectionRecovery,toggleCartVisibility,handleItemOnCart,cartDeleteAPI,deleteAllCartsAPI}from"./cartUtils.min.js";class CollectionGrid extends HTMLElement{constructor(){super()}connectedCallback(){this.boxLoadingPage=document.querySelector(".loading-products"),collectionRecovery(this.boxLoadingPage)}}customElements.get("collection-grid")||customElements.define("collection-grid",CollectionGrid);class ProductModule extends HTMLElement{constructor(){super()}connectedCallback(){this.btnAddToCart=this.querySelector(".js-add-to-cart"),this.btnAddUnit=this.querySelector(".js-add-qty-cart"),this.btnRmvUnit=this.querySelector(".js-rmv-qty-cart"),this.btnRmvAll=this.querySelector(".js-rmv-all-cart"),this.productId=this.getAttribute("data-product"),this.productSku=this.getAttribute("data-sku"),this.productName=this.getAttribute("data-name"),this.productImage=this.getAttribute("data-image"),this.productPrice=parseFloat(this.getAttribute("data-price"));let t={product:this.productId,sku:this.productSku,name:this.productName,image:this.productImage,price:this.productPrice,quantity:1};this.btnAddToCart&&this.btnAddToCart.addEventListener("click",()=>{this.btnAddToCart.querySelector(".loading-spinner").classList.remove("visibility-hidden"),handleItemOnCart(t,"add")}),this.btnAddUnit&&this.btnAddUnit.addEventListener("click",()=>{this.btnAddUnit.closest(".js-cart-item-infos").querySelector(".loading-spinner").classList.remove("visibility-hidden"),handleItemOnCart(t,"add")}),this.btnRmvUnit&&this.btnRmvUnit.addEventListener("click",()=>{this.btnRmvUnit.closest(".js-cart-item-infos").querySelector(".loading-spinner").classList.remove("visibility-hidden"),handleItemOnCart(t,"remove")}),this.btnRmvAll&&this.btnRmvAll.addEventListener("click",()=>{this.btnRmvAll.closest(".js-cart-item-infos").querySelector(".loading-spinner").classList.remove("visibility-hidden"),handleItemOnCart(t,"removeAll")})}}customElements.get("product-module")||customElements.define("product-module",ProductModule),document.addEventListener("DOMContentLoaded",()=>{var t=document.querySelectorAll(".js-close-modal");let e=document.querySelector(".js-cart");var i=document.querySelector(".js-cart-open"),r=JSON.parse(localStorage.getItem("cart"));let o=localStorage.getItem("cartID");var s=document.querySelector(".js-cart-close");let c=document.querySelector(".js-modal-order-success"),l=document.querySelector(".js-modal-order-error"),d=document.querySelector(".js-cart-btn");r=!o||0===o.length||!r||"object"!=typeof r||Array.isArray(r)&&0===r.length;t.forEach(function(t){t.addEventListener("click",function(){document.querySelectorAll(".modal-alert").forEach(function(t){window.location.reload(!0)})})}),i.addEventListener("click",()=>{e.classList.add("cart-opened"),document.body.classList.add("no-scroll")}),s.addEventListener("click",()=>{e.classList.remove("cart-opened"),document.body.classList.add("no-scroll")}),toggleCartVisibility(r),r||(cartRecovery(o),d.addEventListener("click",async()=>{d.querySelector(".loading-spinner").classList.remove("visibility-hidden");var t=await cartDeleteAPI(o);t?(c.classList.remove("visibility-hidden"),localStorage.clear()):(console.error("[toggleCartVisibility] Erro ao finalizar a compra. Não foi possível deletar o carrinho."),l.classList.remove("visibility-hidden"))}))});