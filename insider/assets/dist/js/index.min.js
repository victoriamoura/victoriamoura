import{cartRecovery,collectionRecovery,toggleCartVisibility,handleItemOnCart,cartDeleteAPI,deleteAllCartsAPI}from"../../src/js/cartUtils.js";class CollectionGrid extends HTMLElement{constructor(){super()}connectedCallback(){this.boxLoadingPage=document.querySelector(".loading-products"),collectionRecovery(this.boxLoadingPage)}}customElements.define("collection-grid",CollectionGrid);class ProductModule extends HTMLElement{constructor(){super()}connectedCallback(){this.btnAddToCart=this.querySelector(".js-add-to-cart"),this.btnAddUnit=this.querySelector(".js-add-qty-cart"),this.btnRmvUnit=this.querySelector(".js-rmv-qty-cart"),this.btnRmvAll=this.querySelector(".js-rmv-all-cart"),this.productId=this.getAttribute("data-product"),this.productSku=this.getAttribute("data-sku"),this.productName=this.getAttribute("data-name"),this.productImage=this.getAttribute("data-image"),this.productPrice=parseFloat(this.getAttribute("data-price"));let t={product:this.productId,sku:this.productSku,name:this.productName,image:this.productImage,price:this.productPrice,quantity:1};this.btnAddToCart&&this.btnAddToCart.addEventListener("click",()=>{this.btnAddToCart.querySelector(".loading-spinner").classList.remove("visibility-hidden"),handleItemOnCart(t,"add")}),this.btnAddUnit&&this.btnAddUnit.addEventListener("click",()=>{this.btnAddUnit.closest(".js-cart-item-infos").querySelector(".loading-spinner").classList.remove("visibility-hidden"),handleItemOnCart(t,"add")}),this.btnRmvUnit&&this.btnRmvUnit.addEventListener("click",()=>{this.btnRmvUnit.closest(".js-cart-item-infos").querySelector(".loading-spinner").classList.remove("visibility-hidden"),handleItemOnCart(t,"remove")}),this.btnRmvAll&&this.btnRmvAll.addEventListener("click",()=>{this.btnRmvAll.closest(".js-cart-item-infos").querySelector(".loading-spinner").classList.remove("visibility-hidden"),handleItemOnCart(t,"removeAll")})}}customElements.define("product-module",ProductModule),document.addEventListener("DOMContentLoaded",()=>{document.querySelectorAll(".js-close-modal").forEach(function(t){t.addEventListener("click",function(){document.querySelectorAll(".modal-alert").forEach(function(t){window.location.reload(!0)})})});let t=document.querySelector(".js-cart");var e=document.querySelector(".js-cart-open");let r=JSON.parse(localStorage.getItem("cart")),i=localStorage.getItem("cartID");var o=document.querySelector(".js-cart-close");let s=document.querySelector(".js-modal-order-success"),c=document.querySelector(".js-modal-order-error"),l=document.querySelector(".js-cart-btn");var d=!i||0===i.length||!r||"object"!=typeof r||Array.isArray(r)&&0===r.length;e.addEventListener("click",()=>{t.classList.add("cart-opened"),document.body.classList.add("no-scroll")}),o.addEventListener("click",()=>{t.classList.remove("cart-opened"),document.body.classList.add("no-scroll")}),toggleCartVisibility(d),d||(cartRecovery(i),l.addEventListener("click",async()=>{console.log(r,i);var t=l.querySelector(".loading-spinner"),t=(console.log(t),t.classList.remove("visibility-hidden"),await cartDeleteAPI(i));t?(s.classList.remove("visibility-hidden"),localStorage.clear()):(console.error("Erro ao finalizar a compra. Não foi possível deletar o carrinho."),c.classList.remove("visibility-hidden"))}))});